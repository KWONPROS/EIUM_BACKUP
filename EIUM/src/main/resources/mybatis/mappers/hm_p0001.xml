<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
      PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
   "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="mapper.hm_p0001">
	<resultMap id="P0001resultVO" type="HM_P0001VO">
		<result property="position_CODE" column="POSITION_CODE" />
        <result property="position_NAME" column="POSITION_NAME" />
        <result property="pay_GRADE_CODE" column="PAY_GRADE_CODE"/>
        <result property="pay_GRADE_NAME" column="PAY_GRADE_NAME" />
        <result property="start_DATE" column="START_DATE" />
        <result property="end_DATE" column="END_DATE"/>
        <result property="salary" column="SALARY" />
	</resultMap> 
 <!-- //////////////////////////////////////POSITION_SEARCH///////////////////// -->
	<select id="POSITION_searchList" resultMap="P0001resultVO" parameterType="java.util.Map"> 
      <![CDATA[
         select POSITION_CODE,POSITION_NAME
         from POSITION
      ]]>
      
	</select>
	
	<!-- ///////////////////////////////////PAY_GRADE_SEARCH////////////// -->
	
	<select id="PAY_GRADE_searchList" resultMap="P0001resultVO" parameterType="java.util.Map">
	<![CDATA[
		select PG.PAY_GRADE_CODE, PG.PAY_GRADE_NAME, PGT.SALARY
		from POSITION P, PAY_GRADE PG, PAY_GRADE_TABLE PGT
		where P.position_CODE = PGT.position_CODE 
		AND PG.pay_GRADE_CODE = PGT.pay_GRADE_CODE 
		AND TRIM(PGT.position_CODE) = #{P_POSITION_CODE, jdbcType=VARCHAR}
	]]>
	</select>
	
	<!-- ///////////////////////////////////PAY_GRADE_TABLE_SEARCH////////////// -->
	
	<select id="PAY_GRADE_TABLE_searchList" resultMap="P0001resultVO" parameterType="java.util.Map">
	<![CDATA[
		select PGT.POSITION_CODE, PGT.PAY_GRADE_CODE, PGT.START_DATE, PGT.END_DATE
		from POSITION P, PAY_GRADE PG, PAY_GRADE_TABLE PGT
		where P.position_CODE = PGT.position_CODE 
		AND PG.pay_GRADE_CODE = PGT.pay_GRADE_CODE
		AND TRIM(PGT.pay_GRADE_CODE) = #{P_PAY_GRADE_CODE, jdbcType=VARCHAR} 
		AND TRIM(PGT.position_CODE) = #{PP_POSITION_CODE, jdbcType=VARCHAR}
	]]>
	</select>
	
	<!-- ///////////////////////////////////PAY_GRADE_TABLE_INSERT_UPDATE_DELETE/////////////////////////////////////////////////-->
	<update id="updateData" parameterType="java.util.Map">
		update PAY_GRADE_TABLE
		set  
		     SALARY = #{salary}
		   
		where TRIM(PAY_GRADE) = #{pay_GRADE} AND TRIM(POSITION_CODE) = #{p_position_CODE}
	</update>	
	
	
	<!--INSERT 문(호봉테이블 이력 입력) -->
 	<insert id="insertData" parameterType="java.util.Map">
		insert into PAY_GRADE_TABLE(POSITION_CODE, PAY_GRADE_CODE, START_DATE, END_DATE) 
		select P.POSITION_CODE, PG.PAY_GRADE_CODE, #{start_DATE} AS START_DATE, #{start_DATE} AS END_DATE
		from POSITION P, PAY_GRADE PG
		where TRIM(P.POSITION_CODE) = #{p_position_CODE};
	</insert>	
	
	<delete id="deleteData" parameterType="java.util.Map">
		delete PAY_GRADE_TABLE
		where TRIM(POSITION_CODE) = #{p_position_CODE}
	</delete>


</mapper>