<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
      PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
   "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mapper.hm_p0033">
	<resultMap id="P0033resultVO" type="HM_P0033VO">
		
		<result property="employee_code" column="employee_code" />
		<result property="employee_name" column="employee_name" />		
		<result property="hr_assessment_code" column="hr_assessment_code" />
		<result property="hr_assessment_name" column="hr_assessment_name" />		
		<result property="hr_assessment_test_start_date" column="hr_assessment_test_start_date" />		
		<result property="hr_assessment_test_end_date" column="hr_assessment_test_end_date" />
		<result property="hr_assessment_date" column="hr_assessment_date" />		
		<result property="hr_assessment_master" column="hr_assessment_master" />
		<result property="hr_assessment_reflection_pcnt" column="hr_assessment_reflection_pcnt" />		
		<result property="hr_assessment_score" column="hr_assessment_score" />	
		<result property="hr_assessment_grade" column="hr_assessment_grade" />
		<result property="hr_rnp_code" column="hr_rnp_code" />		
		<result property="hr_rnp_index" column="hr_rnp_index" />
		<result property="hr_rnp_name" column="hr_rnp_name" />		
		<result property="hr_rnp_date" column="hr_rnp_date" />	
		<result property="hr_rnp_history" column="hr_rnp_history" />
		<result property="hr_rnp_institute" column="hr_rnp_institute" />
		<result property="hr_rnp_cost" column="hr_rnp_cost" />
		
		

	
	</resultMap>
	
	

	<select id = "hr_assessment_List" resultMap="P0033resultVO" parameterType="java.util.Map">
	
		select hr_assessment_code, hr_assessment_name
		from hr_assessment
		order by hr_assessment_code
	</select>
	
	
		<select id = "hr_rnp_List" resultMap="P0033resultVO" parameterType="java.util.Map">
	
		select hr_rnp_code, hr_rnp_name
		from hr_rnp
		order by hr_rnp_code
		
	</select>
	
	<select id = "site_List" resultMap="P0033resultVO" parameterType="java.util.Map">
		select site_code, site_name
		from site
		order by site_code		
	</select>
	
	<select id = "employee_List" resultMap="P0033resultVO" parameterType="java.util.Map">
		select ew.employee_code, e.employee_name, d.department_name, s.site_name
		from employee e, employee_work ew, department d, site s
		where e.employee_code = ew.employee_code
		and ew.department_code = d.department_code
		and d.site_code = s.site_code
		order by ew.employee_code	
	</select>
	

		
	
	<select id = "searchList" resultMap="P0033resultVO" parameterType="java.util.Map">
	<choose>
	
			<when test= " hr_assessment_code =='' and site_code  =='' and employee_code == '' and date =='' and date2 =='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_assessment_name, h.hr_assessment_test_start_date, h.hr_assessment_test_end_date, h.hr_assessment_date, h.hr_assessment_master, h.hr_assessment_reflection_pcnt, h.hr_assessment_score, h.hr_assessment_grade
			from employee e, hr_assessment h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			order by e.employee_code
			
			]]> 
   		    </when>	
   		    
   		    
   		   	<when test= " hr_assessment_code =='' and site_code  =='' and employee_code == '' and date =='' and date2 !='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_assessment_name, h.hr_assessment_test_start_date, h.hr_assessment_test_end_date, h.hr_assessment_date, h.hr_assessment_master, h.hr_assessment_reflection_pcnt, h.hr_assessment_score, h.hr_assessment_grade
			from employee e, hr_assessment h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and  to_date(h.hr_assessment_test_end_date,'YYYY-MM-DD') <= to_date(#{date2},'YYYY-MM-DD')
			order by e.employee_code
			
			]]> 
   		    </when>
   		    
   		    
   		   	<when test= " hr_assessment_code =='' and site_code  =='' and employee_code == '' and date !='' and date2 =='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_assessment_name, h.hr_assessment_test_start_date, h.hr_assessment_test_end_date, h.hr_assessment_date, h.hr_assessment_master, h.hr_assessment_reflection_pcnt, h.hr_assessment_score, h.hr_assessment_grade
			from employee e, hr_assessment h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and to_date(#{date},'YYYY-MM-DD') <= to_date(h.hr_assessment_test_start_date,'YYYY-MM-DD')
			order by e.employee_code
			]]> 
   		    </when>
   		    
   		   	<when test= " hr_assessment_code =='' and site_code  =='' and employee_code != '' and date =='' and date2 =='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_assessment_name, h.hr_assessment_test_start_date, h.hr_assessment_test_end_date, h.hr_assessment_date, h.hr_assessment_master, h.hr_assessment_reflection_pcnt, h.hr_assessment_score, h.hr_assessment_grade
			from employee e, hr_assessment h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and e.employee_code = #{employee_code}
			order by e.employee_code
			]]> 
   		    </when>
   		    
   		    
   		   	<when test= " hr_assessment_code =='' and site_code  !='' and employee_code == '' and date =='' and date2 =='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_assessment_name, h.hr_assessment_test_start_date, h.hr_assessment_test_end_date, h.hr_assessment_date, h.hr_assessment_master, h.hr_assessment_reflection_pcnt, h.hr_assessment_score, h.hr_assessment_grade
			from employee e, hr_assessment h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and s.site_code = #{site_code}
			order by e.employee_code
			]]> 
   		    </when>
   		    
   		    
   		   	<when test= " hr_assessment_code !='' and site_code  =='' and employee_code == '' and date =='' and date2 =='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_assessment_name, h.hr_assessment_test_start_date, h.hr_assessment_test_end_date, h.hr_assessment_date, h.hr_assessment_master, h.hr_assessment_reflection_pcnt, h.hr_assessment_score, h.hr_assessment_grade
			from employee e, hr_assessment h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and h.hr_assessment_code = #{hr_assessment_code}
			order by e.employee_code
			]]> 
   		    </when>
   		    
   		    <!-- o 2개인 경우의수 -->
   		    
   		    <when test= " hr_assessment_code !='' and site_code  !='' and employee_code == '' and date =='' and date2 =='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_assessment_name, h.hr_assessment_test_start_date, h.hr_assessment_test_end_date, h.hr_assessment_date, h.hr_assessment_master, h.hr_assessment_reflection_pcnt, h.hr_assessment_score, h.hr_assessment_grade
			from employee e, hr_assessment h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and h.hr_assessment_code = #{hr_assessment_code}
			and s.site_code = #{site_code}
			order by e.employee_code
			
			]]> 
   		    </when>
   		    
   		    
   		    <when test= " hr_assessment_code !='' and site_code  =='' and employee_code != '' and date =='' and date2 =='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_assessment_name, h.hr_assessment_test_start_date, h.hr_assessment_test_end_date, h.hr_assessment_date, h.hr_assessment_master, h.hr_assessment_reflection_pcnt, h.hr_assessment_score, h.hr_assessment_grade
			from employee e, hr_assessment h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and h.hr_assessment_code = #{hr_assessment_code}
			and e.employee_code = #{employee_code}
			order by e.employee_code
			
			]]> 
   		    </when>
   		    
   		    <when test= " hr_assessment_code !='' and site_code  =='' and employee_code == '' and date !='' and date2 =='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_assessment_name, h.hr_assessment_test_start_date, h.hr_assessment_test_end_date, h.hr_assessment_date, h.hr_assessment_master, h.hr_assessment_reflection_pcnt, h.hr_assessment_score, h.hr_assessment_grade
			from employee e, hr_assessment h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and h.hr_assessment_code = #{hr_assessment_code}
			and  to_date(#{date},'YYYY-MM-DD') <= to_date(h.hr_assessment_test_start_date,'YYYY-MM-DD')
			order by e.employee_code
			
			]]> 
   		    </when>
   		    
   		    
   		    <when test= " hr_assessment_code !='' and site_code  =='' and employee_code == '' and date =='' and date2 !='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_assessment_name, h.hr_assessment_test_start_date, h.hr_assessment_test_end_date, h.hr_assessment_date, h.hr_assessment_master, h.hr_assessment_reflection_pcnt, h.hr_assessment_score, h.hr_assessment_grade
			from employee e, hr_assessment h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and h.hr_assessment_code = #{hr_assessment_code}
			and  to_date(h.hr_assessment_test_end_date,'YYYY-MM-DD') <= to_date(#{date2},'YYYY-MM-DD')
			order by e.employee_code
			
			]]> 
   		    </when>
   		    
   		    
   		    <when test= " hr_assessment_code =='' and site_code  !='' and employee_code != '' and date =='' and date2 =='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_assessment_name, h.hr_assessment_test_start_date, h.hr_assessment_test_end_date, h.hr_assessment_date, h.hr_assessment_master, h.hr_assessment_reflection_pcnt, h.hr_assessment_score, h.hr_assessment_grade
			from employee e, hr_assessment h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and s.site_code = #{site_code}
			and e.employee_code = #{employee_code}
			order by e.employee_code
			
			]]> 
   		    </when>
   		    
   		    
   		    <when test= " hr_assessment_code =='' and site_code  !='' and employee_code == '' and date !='' and date2 =='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_assessment_name, h.hr_assessment_test_start_date, h.hr_assessment_test_end_date, h.hr_assessment_date, h.hr_assessment_master, h.hr_assessment_reflection_pcnt, h.hr_assessment_score, h.hr_assessment_grade
			from employee e, hr_assessment h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and s.site_code = #{site_code}
			and  to_date(#{date},'YYYY-MM-DD') <= to_date(h.hr_assessment_test_start_date,'YYYY-MM-DD')
			order by e.employee_code
			
			]]> 
   		    </when>
   		    
   		    
   		    <when test= " hr_assessment_code =='' and site_code  !='' and employee_code == '' and date =='' and date2 !='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_assessment_name, h.hr_assessment_test_start_date, h.hr_assessment_test_end_date, h.hr_assessment_date, h.hr_assessment_master, h.hr_assessment_reflection_pcnt, h.hr_assessment_score, h.hr_assessment_grade
			from employee e, hr_assessment h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and s.site_code = #{site_code}
			and  to_date(h.hr_assessment_test_end_date,'YYYY-MM-DD') <= to_date(#{date2},'YYYY-MM-DD')
			order by e.employee_code
			
			]]> 
   		    </when>
   		    
   		    
   		    <when test= " hr_assessment_code =='' and site_code  =='' and employee_code != '' and date !='' and date2 =='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_assessment_name, h.hr_assessment_test_start_date, h.hr_assessment_test_end_date, h.hr_assessment_date, h.hr_assessment_master, h.hr_assessment_reflection_pcnt, h.hr_assessment_score, h.hr_assessment_grade
			from employee e, hr_assessment h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and e.employee_code = #{employee_code}
			and  to_date(#{date},'YYYY-MM-DD') <= to_date(h.hr_assessment_test_start_date,'YYYY-MM-DD')
			order by e.employee_code
			
			]]> 
   		    </when>
   		    
   		    
   		    <when test= " hr_assessment_code =='' and site_code  =='' and employee_code != '' and date =='' and date2 !='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_assessment_name, h.hr_assessment_test_start_date, h.hr_assessment_test_end_date, h.hr_assessment_date, h.hr_assessment_master, h.hr_assessment_reflection_pcnt, h.hr_assessment_score, h.hr_assessment_grade
			from employee e, hr_assessment h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and e.employee_code = #{employee_code}
			and  to_date(h.hr_assessment_test_end_date,'YYYY-MM-DD') <= to_date(#{date2},'YYYY-MM-DD')
			order by e.employee_code
			
			]]> 
   		    </when>
   		    
   		    
   		    <when test= " hr_assessment_code =='' and site_code  =='' and employee_code == '' and date !='' and date2 !='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_assessment_name, h.hr_assessment_test_start_date, h.hr_assessment_test_end_date, h.hr_assessment_date, h.hr_assessment_master, h.hr_assessment_reflection_pcnt, h.hr_assessment_score, h.hr_assessment_grade
			from employee e, hr_assessment h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and  to_date(#{date},'YYYY-MM-DD') <= to_date(h.hr_assessment_test_start_date,'YYYY-MM-DD')
			and  to_date(h.hr_assessment_test_end_date,'YYYY-MM-DD') <= to_date(#{date2},'YYYY-MM-DD')
			order by e.employee_code
			
			]]> 
   		    </when>

	<!-- o3개 -->
	
			<when test= " hr_assessment_code !='' and site_code  !='' and employee_code != '' and date =='' and date2 =='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_assessment_name, h.hr_assessment_test_start_date, h.hr_assessment_test_end_date, h.hr_assessment_date, h.hr_assessment_master, h.hr_assessment_reflection_pcnt, h.hr_assessment_score, h.hr_assessment_grade
			from employee e, hr_assessment h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and h.hr_assessment_code = #{hr_assessment_code}
			and s.site_code = #{site_code}
			and e.employee_code = #{employee_code}
			order by e.employee_code

			]]> 
   		    </when>	
   		    
			<when test= " hr_assessment_code !='' and site_code  !='' and employee_code == '' and date !='' and date2 =='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_assessment_name, h.hr_assessment_test_start_date, h.hr_assessment_test_end_date, h.hr_assessment_date, h.hr_assessment_master, h.hr_assessment_reflection_pcnt, h.hr_assessment_score, h.hr_assessment_grade
			from employee e, hr_assessment h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and h.hr_assessment_code = #{hr_assessment_code}
			and s.site_code = #{site_code}
			and  to_date(#{date},'YYYY-MM-DD') <= to_date(h.hr_assessment_test_start_date,'YYYY-MM-DD')
			order by e.employee_code
			]]> 
   		    </when>	   		    
	

			<when test= " hr_assessment_code !='' and site_code  !='' and employee_code == '' and date =='' and date2 !='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_assessment_name, h.hr_assessment_test_start_date, h.hr_assessment_test_end_date, h.hr_assessment_date, h.hr_assessment_master, h.hr_assessment_reflection_pcnt, h.hr_assessment_score, h.hr_assessment_grade
			from employee e, hr_assessment h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and h.hr_assessment_code = #{hr_assessment_code}
			and s.site_code = #{site_code}
			and  to_date(h.hr_assessment_test_end_date,'YYYY-MM-DD') <= to_date(#{date2},'YYYY-MM-DD')
			order by e.employee_code
			]]> 
   		    </when>	
   		    
   		    
   		    <when test= " hr_assessment_code !='' and site_code  =='' and employee_code != '' and date !='' and date2 =='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_assessment_name, h.hr_assessment_test_start_date, h.hr_assessment_test_end_date, h.hr_assessment_date, h.hr_assessment_master, h.hr_assessment_reflection_pcnt, h.hr_assessment_score, h.hr_assessment_grade
			from employee e, hr_assessment h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and h.hr_assessment_code = #{hr_assessment_code}
			and e.employee_code = #{employee_code}
			and  to_date(#{date},'YYYY-MM-DD') <= to_date(h.hr_assessment_test_start_date,'YYYY-MM-DD')
			order by e.employee_code
			]]> 
   		    </when>
   		    
   		    
   		    <when test= " hr_assessment_code !='' and site_code  =='' and employee_code != '' and date =='' and date2 !='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_assessment_name, h.hr_assessment_test_start_date, h.hr_assessment_test_end_date, h.hr_assessment_date, h.hr_assessment_master, h.hr_assessment_reflection_pcnt, h.hr_assessment_score, h.hr_assessment_grade
			from employee e, hr_assessment h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and h.hr_assessment_code = #{hr_assessment_code}
			and e.employee_code = #{employee_code}
			and  to_date(h.hr_assessment_test_end_date,'YYYY-MM-DD') <= to_date(#{date2},'YYYY-MM-DD')
			order by e.employee_code
			]]> 
   		    </when>
   		    
   		    <when test= " hr_assessment_code !='' and site_code  =='' and employee_code == '' and date !='' and date2 !='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_assessment_name, h.hr_assessment_test_start_date, h.hr_assessment_test_end_date, h.hr_assessment_date, h.hr_assessment_master, h.hr_assessment_reflection_pcnt, h.hr_assessment_score, h.hr_assessment_grade
			from employee e, hr_assessment h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and h.hr_assessment_code = #{hr_assessment_code}
			and  to_date(#{date},'YYYY-MM-DD') <= to_date(h.hr_assessment_test_start_date,'YYYY-MM-DD')
			and  to_date(h.hr_assessment_test_end_date,'YYYY-MM-DD') <= to_date(#{date2},'YYYY-MM-DD')
			order by e.employee_code
			]]> 
   		    </when>
   		    
   		    <when test= " hr_assessment_code =='' and site_code  !='' and employee_code != '' and date !='' and date2 =='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_assessment_name, h.hr_assessment_test_start_date, h.hr_assessment_test_end_date, h.hr_assessment_date, h.hr_assessment_master, h.hr_assessment_reflection_pcnt, h.hr_assessment_score, h.hr_assessment_grade
			from employee e, hr_assessment h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and s.site_code = #{site_code}
			and e.employee_code = #{employee_code}
			and  to_date(#{date},'YYYY-MM-DD') <= to_date(h.hr_assessment_test_start_date,'YYYY-MM-DD')
			order by e.employee_code
			]]> 
   		    </when>
   		    
   		    <when test= " hr_assessment_code =='' and site_code  !='' and employee_code != '' and date =='' and date2 !='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_assessment_name, h.hr_assessment_test_start_date, h.hr_assessment_test_end_date, h.hr_assessment_date, h.hr_assessment_master, h.hr_assessment_reflection_pcnt, h.hr_assessment_score, h.hr_assessment_grade
			from employee e, hr_assessment h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and s.site_code = #{site_code}
			and e.employee_code = #{employee_code}
			and  to_date(h.hr_assessment_test_end_date,'YYYY-MM-DD') <= to_date(#{date2},'YYYY-MM-DD')
			order by e.employee_code
			]]> 
   		    </when>
   		    
   		    <when test= " hr_assessment_code =='' and site_code  !='' and employee_code == '' and date !='' and date2 !='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_assessment_name, h.hr_assessment_test_start_date, h.hr_assessment_test_end_date, h.hr_assessment_date, h.hr_assessment_master, h.hr_assessment_reflection_pcnt, h.hr_assessment_score, h.hr_assessment_grade
			from employee e, hr_assessment h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and s.site_code = #{site_code}
			and  to_date(#{date},'YYYY-MM-DD') <= to_date(h.hr_assessment_test_start_date,'YYYY-MM-DD')
			and  to_date(h.hr_assessment_test_end_date,'YYYY-MM-DD') <= to_date(#{date2},'YYYY-MM-DD')
			order by e.employee_code
			]]> 
   		    </when>
   		    
   		    
   		    <when test= " hr_assessment_code =='' and site_code  =='' and employee_code != '' and date !='' and date2 !='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_assessment_name, h.hr_assessment_test_start_date, h.hr_assessment_test_end_date, h.hr_assessment_date, h.hr_assessment_master, h.hr_assessment_reflection_pcnt, h.hr_assessment_score, h.hr_assessment_grade
			from employee e, hr_assessment h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and e.employee_code = #{employee_code}
			and  to_date(#{date},'YYYY-MM-DD') <= to_date(h.hr_assessment_test_start_date,'YYYY-MM-DD')
			and  to_date(h.hr_assessment_test_end_date,'YYYY-MM-DD') <= to_date(#{date2},'YYYY-MM-DD')
			order by e.employee_code
			]]> 
   		    </when>
   		    
   		    <when test= " hr_assessment_code !='' and site_code  !='' and employee_code != '' and date !='' and date2 =='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_assessment_name, h.hr_assessment_test_start_date, h.hr_assessment_test_end_date, h.hr_assessment_date, h.hr_assessment_master, h.hr_assessment_reflection_pcnt, h.hr_assessment_score, h.hr_assessment_grade
			from employee e, hr_assessment h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and h.hr_assessment_code = #{hr_assessment_code}
			and s.site_code = #{site_code}
			and e.employee_code = #{employee_code}
			and  to_date(#{date},'YYYY-MM-DD') <= to_date(h.hr_assessment_test_start_date,'YYYY-MM-DD')
			order by e.employee_code
			]]> 
   		    </when>
   		    
   		    <when test= " hr_assessment_code !='' and site_code  !='' and employee_code != '' and date =='' and date2 !='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_assessment_name, h.hr_assessment_test_start_date, h.hr_assessment_test_end_date, h.hr_assessment_date, h.hr_assessment_master, h.hr_assessment_reflection_pcnt, h.hr_assessment_score, h.hr_assessment_grade
			from employee e, hr_assessment h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and h.hr_assessment_code = #{hr_assessment_code}
			and s.site_code = #{site_code}
			and e.employee_code = #{employee_code}
			and  to_date(h.hr_assessment_test_end_date,'YYYY-MM-DD') <= to_date(#{date2},'YYYY-MM-DD')
			order by e.employee_code
			]]> 
   		    </when>
   		    
   		    
   		    <when test= " hr_assessment_code !='' and site_code  !='' and employee_code == '' and date !='' and date2 !='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_assessment_name, h.hr_assessment_test_start_date, h.hr_assessment_test_end_date, h.hr_assessment_date, h.hr_assessment_master, h.hr_assessment_reflection_pcnt, h.hr_assessment_score, h.hr_assessment_grade
			from employee e, hr_assessment h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and h.hr_assessment_code = #{hr_assessment_code}
			and s.site_code = #{site_code}
			and  to_date(#{date},'YYYY-MM-DD') <= to_date(h.hr_assessment_test_start_date,'YYYY-MM-DD')
			and  to_date(h.hr_assessment_test_end_date,'YYYY-MM-DD') <= to_date(#{date2},'YYYY-MM-DD')
			order by e.employee_code
			]]> 
   		    </when>
   		    
   		    
   		    <when test= " hr_assessment_code !='' and site_code  =='' and employee_code != '' and date !='' and date2 !='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_assessment_name, h.hr_assessment_test_start_date, h.hr_assessment_test_end_date, h.hr_assessment_date, h.hr_assessment_master, h.hr_assessment_reflection_pcnt, h.hr_assessment_score, h.hr_assessment_grade
			from employee e, hr_assessment h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and h.hr_assessment_code = #{hr_assessment_code}
			and e.employee_code = #{employee_code}
			and  to_date(#{date},'YYYY-MM-DD') <= to_date(h.hr_assessment_test_start_date,'YYYY-MM-DD')
			and  to_date(h.hr_assessment_test_end_date,'YYYY-MM-DD') <= to_date(#{date2},'YYYY-MM-DD')
			order by e.employee_code
			]]> 
   		    </when>
   		    
   		    <when test= " hr_assessment_code =='' and site_code  !='' and employee_code != '' and date !='' and date2 !='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_assessment_name, h.hr_assessment_test_start_date, h.hr_assessment_test_end_date, h.hr_assessment_date, h.hr_assessment_master, h.hr_assessment_reflection_pcnt, h.hr_assessment_score, h.hr_assessment_grade
			from employee e, hr_assessment h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and s.site_code = #{site_code}
			and e.employee_code = #{employee_code}
			and  to_date(#{date},'YYYY-MM-DD') <= to_date(h.hr_assessment_test_start_date,'YYYY-MM-DD')
			and  to_date(h.hr_assessment_test_end_date,'YYYY-MM-DD') <= to_date(#{date2},'YYYY-MM-DD')
			order by e.employee_code
			]]> 
   		    </when>
   		    
   		    
   		    
	
			<when test= " hr_assessment_code !='' and site_code  !='' and employee_code != '' and date !='' and date2 !='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_assessment_name, h.hr_assessment_test_start_date, h.hr_assessment_test_end_date, h.hr_assessment_date, h.hr_assessment_master, h.hr_assessment_reflection_pcnt, h.hr_assessment_score, h.hr_assessment_grade
			from employee e, hr_assessment h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and h.hr_assessment_code = #{hr_assessment_code}
			and s.site_code = #{site_code}
			and e.employee_code = #{employee_code}
			and  to_date(#{date},'YYYY-MM-DD') <= to_date(h.hr_assessment_test_start_date,'YYYY-MM-DD')
			and  to_date(h.hr_assessment_test_end_date,'YYYY-MM-DD') <= to_date(#{date2},'YYYY-MM-DD')
			order by e.employee_code
			]]> 
   		    </when>

			</choose> 
	</select>
	
	
	
	<select id = "searchList2" resultMap="P0033resultVO" parameterType="java.util.Map">
	<choose>
	
			<when test= " hr_rnp_code =='' and site_code  =='' and employee_code == '' and date =='' and date2 =='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_rnp_name, h.hr_rnp_index, h.hr_rnp_date, h.hr_rnp_institute, h.hr_rnp_cost, h.hr_rnp_history
			from employee e, hr_rnp h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			
			]]> 
   		    </when>	
   		    
   		    
   		   	<when test= " hr_rnp_code =='' and site_code  =='' and employee_code == '' and date =='' and date2 !='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_rnp_name, h.hr_rnp_index, h.hr_rnp_date, h.hr_rnp_institute, h.hr_rnp_cost, h.hr_rnp_history
			from employee e, hr_rnp h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and  to_date(h.hr_rnp_end_date,'YYYY-MM-DD') <= to_date(#{date2},'YYYY-MM-DD')
			
			]]> 
   		    </when>
			

   		    
   		   	<when test= " hr_rnp_code =='' and site_code  =='' and employee_code == '' and date !='' and date2 =='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_rnp_name, h.hr_rnp_index, h.hr_rnp_date, h.hr_rnp_institute, h.hr_rnp_cost, h.hr_rnp_history
			from employee e, hr_rnp h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and to_date(#{date},'YYYY-MM-DD') <= to_date(h.hr_rnp_start_date,'YYYY-MM-DD')
			]]> 
   		    </when>
   		    
   		   	<when test= " hr_rnp_code =='' and site_code  =='' and employee_code != '' and date =='' and date2 =='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_rnp_name, h.hr_rnp_index,  h.hr_rnp_date, h.hr_rnp_institute, h.hr_rnp_cost, h.hr_rnp_history
			from employee e, hr_rnp h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and e.employee_code = #{employee_code}
			]]> 
   		    </when>
   		    
   		    
   		   	<when test= " hr_rnp_code =='' and site_code  !='' and employee_code == '' and date =='' and date2 =='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_rnp_name, h.hr_rnp_index, h.hr_rnp_date, h.hr_rnp_institute, h.hr_rnp_cost, h.hr_rnp_history
			from employee e, hr_rnp h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and s.site_code = #{site_code}
			]]> 
   		    </when>
   		    
   		    
   		   	<when test= " hr_rnp_code !='' and site_code  =='' and employee_code == '' and date =='' and date2 =='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_rnp_name, h.hr_rnp_index, h.hr_rnp_date, h.hr_rnp_institute, h.hr_rnp_cost, h.hr_rnp_history
			from employee e, hr_rnp h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and h.hr_rnp_code = #{hr_rnp_code}
			]]> 
   		    </when>
   		    
   	
   		    
   		    <when test= " hr_rnp_code !='' and site_code  !='' and employee_code == '' and date =='' and date2 =='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_rnp_name, h.hr_rnp_index, h.hr_rnp_date, h.hr_rnp_institute, h.hr_rnp_cost, h.hr_rnp_history
			from employee e, hr_rnp h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and h.hr_rnp_code = #{hr_rnp_code}
			and s.site_code = #{site_code}
			
			]]> 
   		    </when>
   		    
   		    
   		    <when test= " hr_rnp_code !='' and site_code  =='' and employee_code != '' and date =='' and date2 =='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_rnp_name, h.hr_rnp_index, h.hr_rnp_date, h.hr_rnp_institute, h.hr_rnp_cost, h.hr_rnp_history
			from employee e, hr_rnp h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and h.hr_rnp_code = #{hr_rnp_code}
			and e.employee_code = #{employee_code}
			
			]]> 
   		    </when>
   		    
   		    <when test= " hr_rnp_code !='' and site_code  =='' and employee_code == '' and date !='' and date2 =='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_rnp_name, h.hr_rnp_index, h.hr_rnp_date, h.hr_rnp_institute, h.hr_rnp_cost, h.hr_rnp_history
			from employee e, hr_rnp h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and h.hr_rnp_code = #{hr_rnp_code}
			and  to_date(#{date},'YYYY-MM-DD') <= to_date(h.hr_rnp_start_date,'YYYY-MM-DD')

			]]> 
   		    </when>
   		    
   		    
   		    <when test= " hr_rnp_code !='' and site_code  =='' and employee_code == '' and date =='' and date2 !='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_rnp_name, h.hr_rnp_index, h.hr_rnp_date, h.hr_rnp_institute, h.hr_rnp_cost, h.hr_rnp_history
			from employee e, hr_rnp h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and h.hr_rnp_code = #{hr_rnp_code}
			and  to_date(h.hr_rnp_end_date,'YYYY-MM-DD') <= to_date(#{date2},'YYYY-MM-DD')
					
			]]> 
   		    </when>
   		    
   		    
   		    <when test= " hr_rnp_code =='' and site_code  !='' and employee_code != '' and date =='' and date2 =='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_rnp_name, h.hr_rnp_index, h.hr_rnp_date, h.hr_rnp_institute, h.hr_rnp_cost, h.hr_rnp_history
			from employee e, hr_rnp h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and s.site_code = #{site_code}
			and e.employee_code = #{employee_code}
			
			]]> 
   		    </when>
   		    
   		    
   		    <when test= " hr_rnp_code =='' and site_code  !='' and employee_code == '' and date !='' and date2 =='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_rnp_name, h.hr_rnp_index, h.hr_rnp_date, h.hr_rnp_institute, h.hr_rnp_cost, h.hr_rnp_history
			from employee e, hr_rnp h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and s.site_code = #{site_code}
			and  to_date(#{date},'YYYY-MM-DD') <= to_date(h.hr_rnp_start_date,'YYYY-MM-DD')
			
			]]> 
   		    </when>
   		    
   		    
   		    <when test= " hr_rnp_code =='' and site_code  !='' and employee_code == '' and date =='' and date2 !='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_rnp_name, h.hr_rnp_index, h.hr_rnp_date, h.hr_rnp_institute, h.hr_rnp_cost, h.hr_rnp_history
			from employee e, hr_rnp h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and s.site_code = #{site_code}
			and  to_date(h.hr_rnp_end_date,'YYYY-MM-DD') <= to_date(#{date2},'YYYY-MM-DD')
			
			]]> 
   		    </when>
   		    
   		    
   		    <when test= " hr_rnp_code =='' and site_code  =='' and employee_code != '' and date !='' and date2 =='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_rnp_name, h.hr_rnp_index, h.hr_rnp_date, h.hr_rnp_institute, h.hr_rnp_cost, h.hr_rnp_history
			from employee e, hr_rnp h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and e.employee_code = #{employee_code}
			and to_date(#{date},'YYYY-MM-DD') <= to_date(h.hr_rnp_start_date,'YYYY-MM-DD')
			
			]]> 
   		    </when>
   		    
   		    
   		    <when test= " hr_rnp_code =='' and site_code  =='' and employee_code != '' and date =='' and date2 !='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_rnp_name, h.hr_rnp_index, h.hr_rnp_date, h.hr_rnp_institute, h.hr_rnp_cost, h.hr_rnp_history
			from employee e, hr_rnp h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and e.employee_code = #{employee_code}
			and  to_date(h.hr_rnp_end_date,'YYYY-MM-DD') <= to_date(#{date2},'YYYY-MM-DD')
			
			]]> 
   		    </when>
   		    
   		    
   		    <when test= " hr_rnp_code =='' and site_code  =='' and employee_code == '' and date !='' and date2 !='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_rnp_name, h.hr_rnp_index, h.hr_rnp_date, h.hr_rnp_institute, h.hr_rnp_cost, h.hr_rnp_history
			from employee e, hr_rnp h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and  to_date(h.hr_rnp_end_date,'YYYY-MM-DD') <= to_date(#{date2},'YYYY-MM-DD')
			and to_date(#{date},'YYYY-MM-DD') <= to_date(h.hr_rnp_start_date,'YYYY-MM-DD')
			
			]]> 
   		    </when>

	<!-- o3개 -->
	
			<when test= " hr_rnp_code !='' and site_code  !='' and employee_code != '' and date =='' and date2 =='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_rnp_name, h.hr_rnp_index, h.hr_rnp_date, h.hr_rnp_institute, h.hr_rnp_cost, h.hr_rnp_history
			from employee e, hr_rnp h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and h.hr_rnp_code = #{hr_rnp_code}
			and s.site_code = #{site_code}
			and e.employee_code = #{employee_code}

			]]> 
   		    </when>	
   		    
			<when test= " hr_rnp_code !='' and site_code  !='' and employee_code == '' and date !='' and date2 =='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_rnp_name, h.hr_rnp_index, h.hr_rnp_date, h.hr_rnp_institute, h.hr_rnp_cost, h.hr_rnp_history
			from employee e, hr_rnp h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and h.hr_rnp_code = #{hr_rnp_code}
			and s.site_code = #{site_code}
			and to_date(#{date},'YYYY-MM-DD') <= to_date(h.hr_rnp_start_date,'YYYY-MM-DD')
			]]> 
   		    </when>	   		    
	

			<when test= " hr_rnp_code !='' and site_code  !='' and employee_code == '' and date =='' and date2 !='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_rnp_name, h.hr_rnp_index, h.hr_rnp_date, h.hr_rnp_institute, h.hr_rnp_cost, h.hr_rnp_history
			from employee e, hr_rnp h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and h.hr_rnp_code = #{hr_rnp_code}
			and s.site_code = #{site_code}
			and  to_date(h.hr_rnp_end_date,'YYYY-MM-DD') <= to_date(#{date2},'YYYY-MM-DD')
			]]> 
   		    </when>	
   		    
   		    
   		    <when test= " hr_rnp_code !='' and site_code  =='' and employee_code != '' and date !='' and date2 =='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_rnp_name, h.hr_rnp_index, h.hr_rnp_date, h.hr_rnp_institute, h.hr_rnp_cost, h.hr_rnp_history
			from employee e, hr_rnp h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and h.hr_rnp_code = #{hr_rnp_code}
			and e.employee_code = #{employee_code}
			and to_date(#{date},'YYYY-MM-DD') <= to_date(h.hr_rnp_start_date,'YYYY-MM-DD')
			]]> 
   		    </when>
   		    
   		    
   		    <when test= " hr_rnp_code !='' and site_code  =='' and employee_code != '' and date =='' and date2 !='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_rnp_name, h.hr_rnp_index, h.hr_rnp_date, h.hr_rnp_institute, h.hr_rnp_cost, h.hr_rnp_history
			from employee e, hr_rnp h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and h.hr_rnp_code = #{hr_rnp_code}
			and e.employee_code = #{employee_code}
			and  to_date(h.hr_rnp_end_date,'YYYY-MM-DD') <= to_date(#{date2},'YYYY-MM-DD')
			]]> 
   		    </when>
   		    
   		    <when test= " hr_rnp_code !='' and site_code  =='' and employee_code == '' and date !='' and date2 !='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_rnp_name, h.hr_rnp_index, h.hr_rnp_date, h.hr_rnp_institute, h.hr_rnp_cost, h.hr_rnp_history
			from employee e, hr_rnp h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and h.hr_rnp_code = #{hr_rnp_code}
			and  to_date(h.hr_rnp_end_date,'YYYY-MM-DD') <= to_date(#{date2},'YYYY-MM-DD')
					and to_date(#{date},'YYYY-MM-DD') <= to_date(h.hr_rnp_start_date,'YYYY-MM-DD')
			]]> 
   		    </when>
   		    
   		    <when test= " hr_rnp_code =='' and site_code  !='' and employee_code != '' and date !='' and date2 =='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_rnp_name, h.hr_rnp_index, h.hr_rnp_date, h.hr_rnp_institute, h.hr_rnp_cost, h.hr_rnp_history
			from employee e, hr_rnp h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and s.site_code = #{site_code}
			and e.employee_code = #{employee_code}
			and to_date(#{date},'YYYY-MM-DD') <= to_date(h.hr_rnp_start_date,'YYYY-MM-DD')
			]]> 
   		    </when>
   		    
   		    <when test= " hr_rnp_code =='' and site_code  !='' and employee_code != '' and date =='' and date2 !='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_rnp_name, h.hr_rnp_index, h.hr_rnp_date, h.hr_rnp_institute, h.hr_rnp_cost, h.hr_rnp_history
			from employee e, hr_rnp h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and s.site_code = #{site_code}
			and e.employee_code = #{employee_code}
			and  to_date(h.hr_rnp_end_date,'YYYY-MM-DD') <= to_date(#{date2},'YYYY-MM-DD')
			]]> 
   		    </when>
   		    
   		    <when test= " hr_rnp_code =='' and site_code  !='' and employee_code == '' and date !='' and date2 !='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_rnp_name, h.hr_rnp_index, h.hr_rnp_date, h.hr_rnp_institute, h.hr_rnp_cost, h.hr_rnp_history
			from employee e, hr_rnp h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and s.site_code = #{site_code}
			and  to_date(h.hr_rnp_end_date,'YYYY-MM-DD') <= to_date(#{date2},'YYYY-MM-DD')
			and to_date(#{date},'YYYY-MM-DD') <= to_date(h.hr_rnp_start_date,'YYYY-MM-DD')
			]]> 
   		    </when>
   		    
   		    
   		    <when test= " hr_rnp_code =='' and site_code  =='' and employee_code != '' and date !='' and date2 !='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_rnp_name, h.hr_rnp_index, h.hr_rnp_date, h.hr_rnp_institute, h.hr_rnp_cost, h.hr_rnp_history
			from employee e, hr_rnp h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and e.employee_code = #{employee_code}
			and  to_date(h.hr_rnp_end_date,'YYYY-MM-DD') <= to_date(#{date2},'YYYY-MM-DD')
			and to_date(#{date},'YYYY-MM-DD') <= to_date(h.hr_rnp_start_date,'YYYY-MM-DD')
			]]> 
   		    </when>
   		    
   		    <when test= " hr_rnp_code !='' and site_code  !='' and employee_code != '' and date !='' and date2 =='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_rnp_name, h.hr_rnp_index, h.hr_rnp_date, h.hr_rnp_institute, h.hr_rnp_cost, h.hr_rnp_history
			from employee e, hr_rnp h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and h.hr_rnp_code = #{hr_rnp_code}
			and s.site_code = #{site_code}
			and e.employee_code = #{employee_code}
			and to_date(#{date},'YYYY-MM-DD') <= to_date(h.hr_rnp_start_date,'YYYY-MM-DD')
			]]> 
   		    </when>
   		    
   		    <when test= " hr_rnp_code !='' and site_code  !='' and employee_code != '' and date =='' and date2 !='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_rnp_name, h.hr_rnp_index, h.hr_rnp_date, h.hr_rnp_institute, h.hr_rnp_cost, h.hr_rnp_history
			from employee e, hr_rnp h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and h.hr_rnp_code = #{hr_rnp_code}
			and s.site_code = #{site_code}
			and e.employee_code = #{employee_code}
			and  to_date(h.hr_rnp_end_date,'YYYY-MM-DD') <= to_date(#{date2},'YYYY-MM-DD')
			]]> 
   		    </when>
   		    
   		    
   		    <when test= " hr_rnp_code !='' and site_code  !='' and employee_code == '' and date !='' and date2 !='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_rnp_name, h.hr_rnp_index, h.hr_rnp_date, h.hr_rnp_institute, h.hr_rnp_cost, h.hr_rnp_history
			from employee e, hr_rnp h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and h.hr_rnp_code = #{hr_rnp_code}
			and s.site_code = #{site_code}
			and  to_date(h.hr_rnp_end_date,'YYYY-MM-DD') <= to_date(#{date2},'YYYY-MM-DD')
			and to_date(#{date},'YYYY-MM-DD') <= to_date(h.hr_rnp_start_date,'YYYY-MM-DD')
			]]> 
   		    </when>
   		    
   		    
   		    <when test= " hr_rnp_code !='' and site_code  =='' and employee_code != '' and date !='' and date2 !='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_rnp_name, h.hr_rnp_index, h.hr_rnp_date, h.hr_rnp_institute, h.hr_rnp_cost, h.hr_rnp_history
			from employee e, hr_rnp h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and h.hr_rnp_code = #{hr_rnp_code}
			and e.employee_code = #{employee_code}
			and  to_date(h.hr_rnp_end_date,'YYYY-MM-DD') <= to_date(#{date2},'YYYY-MM-DD')
			and to_date(#{date},'YYYY-MM-DD') <= to_date(h.hr_rnp_start_date,'YYYY-MM-DD')
			]]> 
   		    </when>
   		    
   		    <when test= " hr_rnp_code =='' and site_code  !='' and employee_code != '' and date !='' and date2 !='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_rnp_name, h.hr_rnp_index, h.hr_rnp_date, h.hr_rnp_institute, h.hr_rnp_cost, h.hr_rnp_history
			from employee e, hr_rnp h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and s.site_code = #{site_code}
			and e.employee_code = #{employee_code}
			and  to_date(h.hr_rnp_end_date,'YYYY-MM-DD') <= to_date(#{date2},'YYYY-MM-DD')
			and to_date(#{date},'YYYY-MM-DD') <= to_date(h.hr_rnp_start_date,'YYYY-MM-DD')
			]]> 
   		    </when>
   		    
   		    
   		    
	
			<when test= " hr_rnp_code !='' and site_code  !='' and employee_code != '' and date !='' and date2 !='' ">	
			<![CDATA[		
			select e.employee_code, e.employee_name, h.hr_rnp_name, h.hr_rnp_index, h.hr_rnp_date, h.hr_rnp_institute, h.hr_rnp_cost, h.hr_rnp_history
			from employee e, hr_rnp h, employee_work ew, department d, site s
			where e.employee_code = h.employee_code
			and e.employee_code = ew.employee_code
			and ew.department_code = d.department_code
			and d.site_code = s.site_code
			and h.hr_rnp_code = #{hr_rnp_code}
			and s.site_code = #{site_code}
			and e.employee_code = #{employee_code}
			and  to_date(h.hr_rnp_end_date,'YYYY-MM-DD') <= to_date(#{date2},'YYYY-MM-DD')
			and to_date(#{date},'YYYY-MM-DD') <= to_date(h.hr_rnp_start_date,'YYYY-MM-DD')
			]]> 
   		    </when>

			</choose> 
	</select>	
	
	
</mapper>